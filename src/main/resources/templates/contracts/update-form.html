<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<div th:replace="~{fragments/head}">
</div>
<body>
<div class="wrap">
    <nav th:replace="~{fragments/side-navigation-bar}"></nav>
    <!-- content start -->
    <div class="container">
        <header th:replace="~{fragments/header}"></header>
        <div class="header">
            <h2>
                매출 계약서 수정
            </h2>
        </div>
        <!--계약 유형-->
        <div class="content">
            <form method="post" th:action="@{/contracts/sales-form}" onsubmit="return createContract()" th:object="${form}" enctype="multipart/form-data">
                <div class="subTitle02">
                    <h3>매출 계약유형</h3>
                </div>
                <div class="tbl_type02">
                    <table>
                        <colgroup>
                            <col style="width: 15%">
                            <col style="width: 85%">
                        </colgroup>
                        <tr>
                            <th>매출 계약유형</th>
                            <td>
                                <div class="mz-chkbxset">
                                    <div class="chkbx">
                                        <input type="checkbox" id="AWS" name="AWS" value="AWS" onchange="toggleSectionVisibility('AWS', 'aws-section');" />
                                        <label for="AWS">AWS</label>
                                    </div>
                                    <div class="chkbx">
                                        <input type="checkbox" id="PS" name="PS" value="PS" onchange="toggleSectionVisibility('PS', 'ps-section');" />
                                        <label for="PS">PS</label>
                                    </div>
                                    <div class="chkbx">
                                        <input type="checkbox" id="MS" name="MS" value="MS" onchange="toggleSectionVisibility('MS', 'ms-section');" />
                                        <label for="MS">MS</label>
                                    </div>
                                    <div class="chkbx">
                                        <input type="checkbox" id="DP" name="DP" value="DP" onchange="toggleSectionVisibility('DP', 'dp-section');" />
                                        <label for="DP">DP</label>
                                    </div>
                                    <div class="chkbx">
                                        <input type="checkbox" id="OUTSOURCING" name="OUTSOURCING" value="OUTSOURCING" onchange="toggleSectionVisibility('OUTSOURCING', 'outsourcing-section');" />
                                        <label for="OUTSOURCING">외주</label>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>

                <!--계약 기본정보1-->
                <div class="section">
                    <div class="subTitle02">
                        <h3>계약 기본정보 1</h3>
                    </div>
                    <div class="tbl_type02">
                        <table>
                            <colgroup>
                                <col style="width: 25%;">
                                <col style="width: 25%;">
                                <col style="width: 25%;">
                                <col>
                            </colgroup>
                            <tr>
                                <th>매출 계약번호</th>
                                <td>
                                    <input class="inputArea" style="width: 100%;" type="text" th:value="${contract.contractId}" placeholder="매출 계약번호" readonly>
                                </td>

                                <th th:for="salesForceContractId">계약일</th>
                                <td colspan="2">
                                    <div class="search">
                                        <input   th:value="${form}" style="width: 100%;"    type="text" id="datePickerStart"  />
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <th th:for="name">매출 계약명</th>
                                <td colspan="5">
                                    <input class="inputArea" style="width: 67%;" type="text" value="" placeholder="매출 계약명">
                                </td>
                            </tr>
                            <tr>
                                <th th:for="name">Salesforce 계약번호</th>
                                <td colspan="5">
                                    <input class="inputArea" style="width: 67%;" type="text" value="" placeholder="Salesforce 계약번호">
                                </td>
                            </tr>
                            <tr>
                                <th th:for="name">매출 승인 여부</th>
                                <td colspan="5">
                                    <input class="inputArea" style="width: 32%;" type="text" value="" placeholder="매출 승인 여부" readonly>
                                </td>
                            </tr>
                            <tr>
                                <th>매출 갱신 여부</th>
                                <td>
                                    <div class="mz-chkbxset">
                                        <div class="chkbx">
                                            <input type="checkbox" />
                                        </div>
                                    </div>
                                </td>

                                <th th:for="salesForceContractId">갱신전 매출 계약번호</th>
                                <td>
                                    <input class="inputArea" style="width: 100%;" type="text" th:value="{}" placeholder="갱신전 매출 계약번호">
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>

                <div class="subTitle02">
                    <h3>계약 기본정보 2</h3>
                </div>
                <div class="tbl_type02">
                    <table>
                        <colgroup>
                            <col style="width: 25%;">
                            <col style="width: 25%;">
                            <col style="width: 25%;">
                            <col>
                        </colgroup>
                        <tr>
                            <th>접수 방법 구분</th>
                            <td>
                                <select style="width:100%;">
                                    <option>1
                                    </option>
                                    <option>2
                                    </option>
                                </select>
                            </td>

                            <th th:for="salesForceContractId">자사법인</th>
                            <td>
                                <select style="width:100%;">
                                    <option>1
                                    </option>
                                    <option>2
                                    </option>
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <th>서비스 분류</th>
                            <td>
                                <select style="width:100%;">
                                    <option>1
                                    </option>
                                    <option>2
                                    </option>
                                </select>
                            </td>

                            <th th:for="salesForceContractId">체결 분류</th>
                            <td>
                                <select style="width:100%;">
                                    <option>1
                                    </option>
                                    <option>2
                                    </option>
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <th th:for="name">거래처</th>
                            <td colspan="5">
                                <div class="search">
                                    <input class="inputArea" style="width: 40%;" type="text" value="" placeholder="거래처명">
                                    <a onclick="openCustomerPopup();" class="btn_s mL5">검색 </a>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <th th:for="name">계약금액</th>
                            <td colspan="5">
                                <div class="mz-radioset mT10">
                                    <div class="mz-radio">
                                        <input type="radio" name="1" value="" checked="">
                                        <label>고정금액</label>
                                    </div>
                                    <div class="mz-radio">
                                        <input type="radio" name="1" value="">
                                        <label>종량제 과금제</label>
                                    </div>
                                </div>

                                <div>
                                    <select style="width:10%;">
                                        <option>1
                                        </option>
                                        <option>2
                                        </option>
                                    </select>

                                    <input class="inputArea" style="width: 50%;" type="text" value="">

                                    <select style="width:10%;">
                                        <option>1
                                        </option>
                                        <option>2
                                        </option>
                                    </select>

                                    <input type="checkbox" /> 부가세 포함

                                </div>

                                <div>
                                    <input type="checkbox" /> 선납금 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

                                    <input class="inputArea" style="width: 50%;" type="text" value="">

                                    <select style="width:10%;">
                                        <option>1
                                        </option>
                                        <option>2
                                        </option>
                                    </select>

                                </div>

                                <div>
                                    특이사항&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input class="inputArea" style="width: 50%;" type="text" value="">
                                </div>

                            </td>
                        </tr>
                        <tr>
                            <th th:for="name">계약기간</th>
                            <td colspan="2">
                                <div class="search">
                                    <input style="width: 100%;" type="text" id="datePickerStart1" data-mindate="today" />
                                    <p class="mL10 mR10">~</p>
                                    <input style="width: 100%;" type="text" id="datePickerEnd1" data-mindate="today" />
                                </div>
                            </td>
                            <td>
                                <div class="mz-chkbxset">
                                    <div class="chkbx">
                                        <input type="checkbox"/> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;종료일 해지 시까지로 설정
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <th th:for="name">청구기간</th>
                            <td colspan="2">
                                <div class="search">
                                    <input style="width: 100%;" type="text" id="datePickerStart2" data-mindate="today" />
                                    <p class="mL10 mR10">~</p>
                                    <input style="width: 100%;" type="text" id="datePickerEnd2" data-mindate="today" />
                                </div>
                            </td>
                            <td>
                                <div class="mz-chkbxset">
                                    <div class="chkbx">
                                        <input type="checkbox"/> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;계약기간과 동일
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <th th:for="name">지불조건</th>
                            <td colspan="5">
                                <div>
                                    <input type="radio" name="status" id="status01" value="">
                                    <label for="status01">익월</label>

                                    <select style="width:10%;">
                                        <option>1
                                        </option>
                                        <option>2
                                        </option>
                                    </select>
                                    일 이내 세금계산서 발행 후 말일 이내 계좌이체 지불
                                </div>

                                <div>
                                    <input type="radio" name="status" id="status02" value="">
                                    <label for="status01">익월</label>

                                    <select style="width:10%;">
                                        <option>1
                                        </option>
                                        <option>2
                                        </option>
                                    </select>
                                    일 이내 신용카드 결제
                                </div>

                                <div>
                                    <input type="radio" name="status" id="status03" value="">
                                    <label for="status01">기타</label>

                                    <input class="inputArea" style="width: 80%;" type="text" value="" placeholder="">
                                </div>

                            </td>

                        </tr>
                        <tr>
                            <th>계약팀 담당자</th>
                            <td>
                                <div class="search">
                                    <input class="inputArea" style="width: 100%;" type="text" value="" placeholder="계약팀 담당자">
                                    <a onclick="openChargerPopup();" class="btn_s mL5">검색</a>
                                </div>
                            </td>

                            <th>세일즈 담당자</th>
                            <td>
                                <div class="search">
                                    <input class="inputArea" style="width: 100%;" type="text" value="" placeholder="세일즈 담당자">
                                    <a onclick="openChargerPopup();" class="btn_s mL5">검색</a>
                                </div>
                            </td>
                        </tr>

                        <tr>
                            <th th:for="name">EDM Link URL</th>
                            <td colspan="5">
                                <input class="inputArea" style="width: 67%;" type="text" value="">
                            </td>
                        </tr>

                        <tr>
                            <th th:for="name">청구방법</th>
                            <td colspan="5">
                                <select style="width:32%;">
                                    <option>세금계산서
                                    </option>
                                    <option>2
                                    </option>
                                </select>
                            </td>
                        </tr>

                        <tr>
                            <th>세금계산서 작성일</th>
                            <td>
                                <select style="width:100%;">
                                    <option>당월(말일)
                                    </option>
                                    <option>2
                                    </option>
                                </select>
                            </td>

                            <th>세금계산서 수신 메일</th>
                            <td>
                                <input class="inputArea" style="width: 100%;" type="text" value="" placeholder="메일주소">
                            </td>
                        </tr>


                        <tr>
                            <th th:for="name">AWS 통합 빌링(신규)</th>
                            <td colspan="5">
                                <div class="mz-chkbxset">
                                    <div class="chkbx">
                                        <input type="checkbox" />
                                    </div>
                                </div>
                            </td>
                        </tr>


                        <tr>
                            <th>특이사항</th>
                            <td colspan="5">
                                <textarea style="width: 100%; height:100px;"></textarea>
                            </td>
                        </tr>


                    </table>
                </div>

                <div class="section">
                    <div class="subTitle02">
                        <h3>고객사 담당자</h3>
                        <div>
                            <button type="button" class="btn btn-add" onclick="addClient()">담당자 추가</button>
                        </div>
                    </div>
                    <div class="tbl_type02">
                        <table id="forList">
                            <colgroup>
                                <col width="10%">
                                <col width="20%">
                                <col width="20%">
                                <col>
                                <col width="20%">
                            </colgroup>
                            <tr>
                                <th class="center">No</th>
                                <th class="center">담당자 구분</th>
                                <th class="center">이름</th>
                                <th class="center">이메일</th>
                                <th class="center">비고</th>
                            </tr>
                            <tr>
                                <td></td>
                                <td>
                                    <select style="width:100%;">
                                        <option>
                                        </option>
                                    </select>
                                </td>
                                <td>
                                    <input class="inputArea" style="width: 100%;" type="text" placeholder="이름" />
                                </td>
                                <td>
                                    <input class="inputArea" style="width: 100%;" type="text" placeholder="이메일" />
                                </td>
                                <td>
                                    <input class="inputArea" style="width: 100%;" type="text" placeholder="비고" />
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>

                <div class="tbl_type02">
                    <h3 th:style="'margin:30px 0px 0px 0px'">증빙서류</h3>
                    <table >
                        <colgroup>
                            <col style="width:15%;">
                            <col>
                        </colgroup>
                        <tr>
                            <th class="center">계약서</th>
                            <td>
                                <p  th:text="'선택된 파일 없음'" type="file" ></p>
                            </td>
                        </tr>
                        <tr>
                            <th class="center">사업자 등록증</th>
                            <td>
                                <p th:text="'선택된 파일 없음'" type="file" ></p>
                            </td>
                        </tr>
                        <tr>
                            <th class="center">비밀유지계약서</th>
                            <td>
                                <p th:text="'선택된 파일 없음'" type="file" ></p>
                            </td>
                        </tr>
                        <tr>
                            <th class="center">첨부문서</th>
                            <td>
                                <div><input class="inputArea"  type="text" value="" placeholder="이용계약 일반조건"/> 일반조건 <span th:text="'선택된 파일 없음'" type="file" ></span><span th:style="'border: 1px solid #000'">X</span></div>
                                <div><input class="inputArea"  type="text" value="" placeholder="서비스 상세"/> <span th:text="'선택된 파일 없음'" type="file" ></span><span th:style="'border: 1px solid #000'">X</span></div>
                                <div><input class="inputArea"  type="text" value="" placeholder="환율 정책"/> <span th:text="'선택된 파일 없음'" type="file" ></span><span th:style="'border: 1px solid #000'">X</span></div>
                            </td>
                        </tr>
                        <tr>
                            <th class="center">툭이사항</th>
                            <td>
                                * 첨부문서는 본 계약서의 일부를 구성한다.</br>
                                매월 AWS 이용료 3%할인</br>
                                AWS Super Plan : Business 등급 할인 - 매월 AWS 이용료의 5%로 할인 청구</br>
                                (상세 내용은 [첨부2 클라우드 서비스 상세] 참조)</br>
                            </td>
                        </tr>
                    </table>
                </div>
        </div>


        <!-- 등록 버튼 -->
        <div class="btn-wrap">
            <button class="btn btn-blue" type="submit"  name="action" value="temporary">수정</button>
            <a class="btn btn-wt" th:href="@{/contracts}" >취소</a>
        </div>
        <!-- 버튼 -->
        </form>
    </div>
    <!-- content end -->
</div>

<script>
    let rowIndex = 1;
    const fields = {
        type: "담당자 구분",
        name: "이름",
        email: "이메일",
        etc: "비고"
    }

    function addClient() {
        const clonedSelect = document.getElementById("clientInfos0.type")
            .cloneNode(true);
        const table = document.getElementById('forList');
        const newRow = table.insertRow(-1);

        const indexCell = newRow.insertCell(0);
        indexCell.classList.add('center');
        indexCell.textContent = rowIndex + 1;

        Object.keys(fields)
            .forEach((fieldKey, index) => {
                const cell = newRow.insertCell(index + 1);
                if (fieldKey === 'type') {
                    clonedSelect.id = `clientInfos${rowIndex}.${fieldKey}`;
                    clonedSelect.name = `clientInfos[${rowIndex}].${fieldKey}`;
                    cell.appendChild(clonedSelect);
                    return;
                }

                const input = document.createElement('input');
                input.classList.add('inputArea');
                input.style.width = '100%';
                input.type = 'text';
                input.value = '';
                input.placeholder = fields[fieldKey];
                input.id = `clientInfos${rowIndex}.${fieldKey}`;
                input.name = `clientInfos[${rowIndex}].${fieldKey}`;
                cell.appendChild(input);
            });

        rowIndex++;
    }
</script>

<script>
    $(function () {
        $('#datePickerStart, #datePickerEnd')
            .datepicker();
    });

    function createContract() {
        const isCreated = confirm("계약을 등록하시겠습니까?");
        if (isCreated) {
            $("input[type='radio']")
                .attr("disabled", false);
            $("select")
                .attr("disabled", false);
        }
        return isCreated;
    }
</script>
</div>
</body>
</html>